(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[863],{7270:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/upload",function(){return t(7611)}])},7611:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return r}});var s=t(5893),a=t(7294),n=t(7536);function r(){let{register:e,handleSubmit:l,watch:t,reset:r,formState:c}=(0,n.cI)({defaultValues:{title:"",style:"",blackAndWhite:!1,notes:""}}),[i,d]=(0,a.useState)(null),[o,u]=(0,a.useState)(0),p=t("file"),m=p&&p.length>0?URL.createObjectURL(p[0]):null;(0,a.useEffect)(()=>()=>{m&&URL.revokeObjectURL(m)},[m]);let x=async e=>{d(null),u(0);let l=new FormData;l.append("file",e.file[0]),l.append("title",e.title),l.append("style",e.style),l.append("blackAndWhite",e.blackAndWhite.toString()),l.append("notes",e.notes);let t=new XMLHttpRequest;t.open("POST","/api/uploads"),t.upload.onprogress=e=>{e.lengthComputable&&u(Math.round(e.loaded/e.total*100))},t.onload=()=>{if(200===t.status){let e=JSON.parse(t.responseText);e.ok?(d("✅ Uploaded: ".concat(e.key)),r(),u(0)):d("❌ ".concat(e.error||"Upload failed"))}else d("❌ Server error: ".concat(t.status))},t.onerror=()=>d("❌ Network error"),t.send(l)};return(0,s.jsxs)("main",{className:"max-w-md mx-auto p-4 space-y-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Upload a Sketch"}),(0,s.jsxs)("form",{onSubmit:l(x),className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium mb-1",children:"File"}),(0,s.jsx)("input",{...e("file",{required:!0}),type:"file",accept:"image/*",className:"block w-full"}),c.errors.file&&(0,s.jsx)("p",{className:"text-red-600",children:"Please select a file."})]}),m&&(0,s.jsxs)("div",{className:"border p-2",children:[(0,s.jsx)("p",{className:"text-sm mb-1",children:"Preview:"}),(0,s.jsx)("img",{src:m,className:"max-h-48 object-contain",alt:"Preview"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium mb-1",children:"Title"}),(0,s.jsx)("input",{...e("title",{required:!0}),type:"text",className:"w-full border rounded px-2 py-1",placeholder:"My beautiful tree"}),c.errors.title&&(0,s.jsx)("p",{className:"text-red-600",children:"Title is required."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium mb-1",children:"Style"}),(0,s.jsx)("input",{...e("style"),type:"text",className:"w-full border rounded px-2 py-1",placeholder:"e.g. watercolour, pen"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{...e("blackAndWhite"),type:"checkbox",id:"bw"}),(0,s.jsx)("label",{htmlFor:"bw",children:"Black & White"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium mb-1",children:"Notes"}),(0,s.jsx)("textarea",{...e("notes"),rows:3,className:"w-full border rounded px-2 py-1",placeholder:"Any thoughts or context…"})]}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded disabled:opacity-50",disabled:o>0&&o<100,children:o>0&&o<100?"Uploading… ".concat(o,"%"):"Upload Sketch"})]}),i&&(0,s.jsx)("p",{className:"mt-4 font-medium",children:i})]})}}},function(e){e.O(0,[536,888,774,179],function(){return e(e.s=7270)}),_N_E=e.O()}]);