globalThis.disableIncrementalCache = false;globalThis.disableDynamoDBCache = false;globalThis.isNextAfter15 = false;globalThis.openNextDebug = false;globalThis.openNextVersion = "3.7.0";
var m=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var E=(a,e)=>{for(var t in e)m(a,t,{get:e[t],enumerable:!0})},R=(a,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of N(e))!P.call(a,i)&&i!==t&&m(a,i,{get:()=>e[i],enumerable:!(n=y(e,i))||n.enumerable});return a};var A=a=>R(m({},"__esModule",{value:!0}),a);var F={};E(F,{default:()=>u});module.exports=A(F);function h(a){try{return"__openNextInternal"in a}catch{return!1}}function c(...a){globalThis.openNextDebug&&console.log(...a)}function T(...a){console.warn(...a)}var B=[{clientName:"S3Client",commandName:"GetObjectCommand",errorName:"NoSuchKey"}],M=a=>B.some(e=>e.clientName===a?.clientName&&e.commandName===a?.commandName&&(e.errorName===a?.error?.name||e.errorName===a?.error?.Code));function b(...a){if(a.some(e=>M(e)))return c(...a);if(a.some(e=>h(e))){let e=a.find(t=>h(t));return e.logLevel<S()?void 0:e.logLevel===0?console.log(...a.map(t=>h(t)?`${t.name}: ${t.message}`:t)):e.logLevel===1?T(...a.map(t=>h(t)?`${t.name}: ${t.message}`:t)):console.error(...a)}console.error(...a)}function S(){switch((process.env.OPEN_NEXT_ERROR_LOG_LEVEL??"1").toLowerCase()){case"debug":case"0":return 0;case"error":case"2":return 2;default:return 1}}async function g(a,e,t){if(globalThis.openNextConfig.dangerous?.disableTagCache)return!1;if(!t.value)return!0;if("type"in t&&t.type==="page")return!1;let i=t.lastModified??Date.now();return globalThis.tagCache.mode==="nextMode"?await globalThis.tagCache.hasBeenRevalidated(e,i):await globalThis.tagCache.getLastModified(a,i)===-1}function _(a){if(!a)return[];try{return a.meta?.headers?.["x-next-cache-tags"]?.split(",")??[]}catch{return[]}}function O(a){return typeof a=="string"?a:JSON.stringify({tag:a.tag,path:a.path})}async function f(a){let e=globalThis.__openNextAls.getStore();if(c("Writing tags",a,e),!e||globalThis.openNextConfig.dangerous?.disableTagCache)return;let t=a.filter(n=>{let i=O(n),o=!e.writtenTags.has(i);return o&&e.writtenTags.add(i),o});t.length!==0&&await globalThis.tagCache.writeTags(t)}var I=new Set(["application/octet-stream","application/epub+zip","application/msword","application/pdf","application/rtf","application/vnd.amazon.ebook","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","font/otf","font/woff","font/woff2","image/bmp","image/gif","image/jpeg","image/png","image/tiff","image/vnd.microsoft.icon","image/webp","audio/3gpp","audio/aac","audio/basic","audio/flac","audio/mpeg","audio/ogg","audio/wavaudio/webm","audio/x-aiff","audio/x-midi","audio/x-wav","video/3gpp","video/mp2t","video/mpeg","video/ogg","video/quicktime","video/webm","video/x-msvideo","application/java-archive","application/vnd.apple.installer+xml","application/x-7z-compressed","application/x-apple-diskimage","application/x-bzip","application/x-bzip2","application/x-gzip","application/x-java-archive","application/x-rar-compressed","application/x-tar","application/x-zip","application/zip","application/x-protobuf"]);function v(a){if(!a)return!1;let e=a?.split(";")[0]??"";return I.has(e)}function L(a){return typeof a=="boolean"?a:typeof a=="object"?a.kindHint==="fetch"||a.fetchCache||a.kind==="FETCH":!1}var u=class{async get(e,t){if(globalThis.openNextConfig.dangerous?.disableIncrementalCache)return null;let n=typeof t=="object"?t.softTags:[],i=typeof t=="object"?t.tags:[];return L(t)?this.getFetchCache(e,n,i):this.getIncrementalCache(e)}async getFetchCache(e,t,n){c("get fetch cache",{key:e,softTags:t,tags:n});try{let i=await globalThis.incrementalCache.get(e,"fetch");if(i?.value===void 0)return null;let o=[...n??[],...t??[]],s=i.lastModified??Date.now();if(await g(e,o,i))return null;if((n??[]).length===0){let r=t?.find(d=>d.startsWith("_N_T_/")&&!d.endsWith("layout")&&!d.endsWith("page"));if(r&&await g(r.replace("_N_T_/",""),[],i))return null}return{lastModified:s,value:i.value}}catch(i){return c("Failed to get fetch cache",i),null}}async getIncrementalCache(e){try{let t=await globalThis.incrementalCache.get(e,"cache");if(!t?.value)return null;let n=t.value,i=n.meta,o=_(n),s=t.lastModified??Date.now();if(await g(e,o,t))return null;let r=globalThis.__openNextAls.getStore();return r&&(r.lastModified=s),n?.type==="route"?{lastModified:s,value:{kind:globalThis.isNextAfter15?"APP_ROUTE":"ROUTE",body:Buffer.from(n.body??Buffer.alloc(0),v(String(i?.headers?.["content-type"]))?"base64":"utf8"),status:i?.status,headers:i?.headers}}:n?.type==="page"||n?.type==="app"?globalThis.isNextAfter15&&n?.type==="app"?{lastModified:s,value:{kind:"APP_PAGE",html:n.html,rscData:Buffer.from(n.rsc),status:i?.status,headers:i?.headers,postponed:i?.postponed}}:{lastModified:s,value:{kind:globalThis.isNextAfter15?"PAGES":"PAGE",html:n.html,pageData:n.type==="page"?n.json:n.rsc,status:i?.status,headers:i?.headers}}:n?.type==="redirect"?{lastModified:s,value:{kind:"REDIRECT",props:n.props}}:(T("Unknown cache type",n),null)}catch(t){return c("Failed to get body cache",t),null}}async set(e,t,n){if(globalThis.openNextConfig.dangerous?.disableIncrementalCache)return;let i=globalThis.__openNextAls.getStore()?.pendingPromiseRunner.withResolvers();try{if(t==null)await globalThis.incrementalCache.delete(e);else{let o=this.extractRevalidateForSet(n);switch(t.kind){case"ROUTE":case"APP_ROUTE":{let{body:s,status:l,headers:r}=t;await globalThis.incrementalCache.set(e,{type:"route",body:s.toString(v(String(r["content-type"]))?"base64":"utf8"),meta:{status:l,headers:r},revalidate:o},"cache");break}case"PAGE":case"PAGES":{let{html:s,pageData:l,status:r,headers:d}=t;typeof l=="string"?await globalThis.incrementalCache.set(e,{type:"app",html:s,rsc:l,meta:{status:r,headers:d},revalidate:o},"cache"):await globalThis.incrementalCache.set(e,{type:"page",html:s,json:l,revalidate:o},"cache");break}case"APP_PAGE":{let{html:s,rscData:l,headers:r,status:d}=t;await globalThis.incrementalCache.set(e,{type:"app",html:s,rsc:l.toString("utf8"),meta:{status:d,headers:r},revalidate:o},"cache");break}case"FETCH":await globalThis.incrementalCache.set(e,t,"fetch");break;case"REDIRECT":await globalThis.incrementalCache.set(e,{type:"redirect",props:t.props,revalidate:o},"cache");break;case"IMAGE":break}}await this.updateTagsOnSet(e,t,n),c("Finished setting cache")}catch(o){b("Failed to set cache",o)}finally{i?.resolve()}}async revalidateTag(e){let t=globalThis.openNextConfig.dangerous;if(t?.disableTagCache||t?.disableIncrementalCache)return;let n=Array.isArray(e)?e:[e];if(n.length!==0)try{if(globalThis.tagCache.mode==="nextMode"){let i=await globalThis.tagCache.getPathsByTags?.(n)??[];await f(n),i.length>0&&await globalThis.cdnInvalidationHandler.invalidatePaths(i.map(o=>({initialPath:o,rawPath:o,resolvedRoutes:[{route:o,type:"app"}]})));return}for(let i of n){c("revalidateTag",i);let o=await globalThis.tagCache.getByTag(i);c("Items",o);let s=o.map(r=>({path:r,tag:i}));if(i.startsWith("_N_T_/"))for(let r of o){let x=(await globalThis.tagCache.getByPath(r)).filter(p=>!p.startsWith("_N_T_/"));for(let p of x){let w=await globalThis.tagCache.getByTag(p);c({hardTag:p,_paths:w}),s.push(...w.map(C=>({path:C,tag:p})))}}await f(s);let l=Array.from(new Set(s.filter(r=>r.tag.startsWith("_N_T_/")).map(r=>`/${r.path}`)));l.length>0&&await globalThis.cdnInvalidationHandler.invalidatePaths(l.map(r=>({initialPath:r,rawPath:r,resolvedRoutes:[{route:r,type:"app"}]})))}}catch(i){b("Failed to revalidate tag",i)}}async updateTagsOnSet(e,t,n){if(globalThis.openNextConfig.dangerous?.disableTagCache||globalThis.tagCache.mode==="nextMode"||!t)return;let i=t?.kind==="FETCH"?n?.tags??t?.data?.tags??[]:t?.kind==="PAGE"?t.headers?.["x-next-cache-tags"]?.split(",")??[]:[];c("derivedTags",i);let o=await globalThis.tagCache.getByPath(e),s=i.filter(l=>!o.includes(l));s.length>0&&await f(s.map(l=>({path:e,tag:l,revalidatedAt:1})))}extractRevalidateForSet(e){if(e!==void 0){if(typeof e=="number"||e===!1)return e;if("revalidate"in e)return e.revalidate;if("cacheControl"in e)return e.cacheControl?.revalidate}}};
