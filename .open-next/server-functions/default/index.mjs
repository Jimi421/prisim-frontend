globalThis.monorepoPackagePath = "";import process from 'node:process';import { Buffer } from 'node:buffer';import { createRequire as topLevelCreateRequire } from 'module';const require = topLevelCreateRequire(import.meta.url);import bannerUrl from 'url';const __dirname = bannerUrl.fileURLToPath(new URL('.', import.meta.url));globalThis.openNextDebug = false;globalThis.openNextVersion = "3.6.5";
var Rt=Object.create;var ae=Object.defineProperty;var Et=Object.getOwnPropertyDescriptor;var _t=Object.getOwnPropertyNames;var bt=Object.getPrototypeOf,vt=Object.prototype.hasOwnProperty;var P=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var R=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ct=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),S=(e,t)=>{for(var r in t)ae(e,r,{get:t[r],enumerable:!0})},Pt=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of _t(t))!vt.call(e,a)&&a!==r&&ae(e,a,{get:()=>t[a],enumerable:!(o=Et(t,a))||o.enumerable});return e};var St=(e,t,r)=>(r=e!=null?Rt(bt(e)):{},Pt(t||!e||!e.__esModule?ae(r,"default",{value:e,enumerable:!0}):r,e));function q(e){try{return"__openNextInternal"in e}catch{return!1}}var O,G,V=R(()=>{O=class extends Error{__openNextInternal=!0;canIgnore=!0;logLevel=0;constructor(t){super(t),this.name="IgnorableError"}},G=class extends Error{__openNextInternal=!0;canIgnore=!1;logLevel=2;constructor(t){super(t),this.name="FatalError"}}});function u(...e){globalThis.openNextDebug&&console.log(...e)}function Nt(...e){console.warn(...e)}function w(...e){if(e.some(t=>Lt(t)))return u(...e);if(e.some(t=>q(t))){let t=e.find(r=>q(r));return t.logLevel<kt()?void 0:t.logLevel===0?console.log(...e.map(r=>q(r)?`${r.name}: ${r.message}`:r)):t.logLevel===1?Nt(...e.map(r=>q(r)?`${r.name}: ${r.message}`:r)):console.error(...e)}console.error(...e)}function kt(){switch((process.env.OPEN_NEXT_ERROR_LOG_LEVEL??"1").toLowerCase()){case"debug":case"0":return 0;case"error":case"2":return 2;default:return 1}}var At,Lt,y=R(()=>{V();At=[{clientName:"S3Client",commandName:"GetObjectCommand",errorName:"NoSuchKey"}],Lt=e=>At.some(t=>t.clientName===e?.clientName&&t.commandName===e?.commandName&&(t.errorName===e?.error?.name||t.errorName===e?.error?.Code))});function K(e){return e?typeof e=="string"?e.split(/(?<!Expires=\w+),/i).map(t=>t.trim()):e:[]}function ie(e){let t={};for(let[r,o]of e)r in t?Array.isArray(t[r])?t[r].push(o):t[r]=[t[r],o]:t[r]=o;return t}var J,Ht,B=R(()=>{J=e=>{let t={};if(!e)return t;for(let[r,o]of Object.entries(e))o!==void 0&&(t[r.toLowerCase()]=Ht(o));return t},Ht=e=>typeof e=="string"?e:Array.isArray(e)?e.join(","):String(e)});import{Readable as ee}from"node:stream";function j(){return process.env.OPEN_NEXT_FORCE_NON_EMPTY_RESPONSE==="true"?ee.toWeb(ee.from([Buffer.from("SOMETHING")])):ee.toWeb(ee.from([]))}var I=R(()=>{});function ue(e){return ie(e.entries())}var pe=R(()=>{B()});var Ve=Ct(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.parse=wr;oe.serialize=yr;var pr=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,fr=/^[\u0021-\u003A\u003C-\u007E]*$/,mr=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,hr=/^[\u0020-\u003A\u003D-\u007E]*$/,xr=Object.prototype.toString,gr=(()=>{let e=function(){};return e.prototype=Object.create(null),e})();function wr(e,t){let r=new gr,o=e.length;if(o<2)return r;let a=t?.decode||Rr,n=0;do{let s=e.indexOf("=",n);if(s===-1)break;let i=e.indexOf(";",n),d=i===-1?o:i;if(s>d){n=e.lastIndexOf(";",s-1)+1;continue}let f=Qe(e,n,s),l=Ge(e,s,f),c=e.slice(f,l);if(r[c]===void 0){let p=Qe(e,s+1,d),h=Ge(e,d,p),x=a(e.slice(p,h));r[c]=x}n=d+1}while(n<o);return r}function Qe(e,t,r){do{let o=e.charCodeAt(t);if(o!==32&&o!==9)return t}while(++t<r);return r}function Ge(e,t,r){for(;t>r;){let o=e.charCodeAt(--t);if(o!==32&&o!==9)return t+1}return r}function yr(e,t,r){let o=r?.encode||encodeURIComponent;if(!pr.test(e))throw new TypeError(`argument name is invalid: ${e}`);let a=o(t);if(!fr.test(a))throw new TypeError(`argument val is invalid: ${t}`);let n=e+"="+a;if(!r)return n;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);n+="; Max-Age="+r.maxAge}if(r.domain){if(!mr.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);n+="; Domain="+r.domain}if(r.path){if(!hr.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);n+="; Path="+r.path}if(r.expires){if(!Er(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);n+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(n+="; HttpOnly"),r.secure&&(n+="; Secure"),r.partitioned&&(n+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":n+="; Priority=Low";break;case"medium":n+="; Priority=Medium";break;case"high":n+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"none":n+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return n}function Rr(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function Er(e){return xr.call(e)==="[object Date]"}});var Ke={};S(Ke,{default:()=>vr});import{Buffer as _r}from"node:buffer";var Je,br,vr,Ye=R(()=>{Je=St(Ve(),1);B();pe();br={convertFrom:async e=>{let t=new URL(e.url),r=t.searchParams,o=ue(r),a=await e.arrayBuffer(),n={};e.headers.forEach((c,p)=>{n[p]=c});let s=t.pathname,i=e.method,d=i!=="GET"&&i!=="HEAD",f=e.headers.get("cookie"),l=f?Je.default.parse(f):{};return{type:"core",method:i,rawPath:s,url:e.url,body:d?_r.from(a):void 0,headers:n,remoteAddress:e.headers.get("x-forwarded-for")??"::1",query:o,cookies:l}},convertTo:async e=>{if("internalEvent"in e){let r=new Request(e.internalEvent.url,{body:e.internalEvent.body,method:e.internalEvent.method,headers:{...e.internalEvent.headers,"x-forwarded-host":e.internalEvent.headers.host}});if(globalThis.__dangerous_ON_edge_converter_returns_request===!0)return r;let o=(e.isISR||e.internalEvent.rawPath.startsWith("/_next/image"))&&process.env.DISABLE_CACHE!=="true"?{cacheEverything:!0}:{};return fetch(r,{cf:o})}let t=new Headers;for(let[r,o]of Object.entries(e.headers)){if(r==="set-cookie"&&typeof o=="string"){let a=K(o);for(let n of a)t.append(r,n);continue}if(Array.isArray(o))for(let a of o)t.append(r,a);else t.set(r,o)}return new Response(e.body,{status:e.statusCode,headers:t})},name:"edge"},vr=br});var Ze={};S(Ze,{default:()=>Nr});import{Writable as Cr}from"node:stream";var Pr,Sr,Nr,et=R(()=>{Pr=new Set([101,204,205,304]),Sr=async(e,t)=>async(r,o,a)=>{globalThis.process=process;for(let[l,c]of Object.entries(o))typeof c=="string"&&(process.env[l]=c);let n=await t.convertFrom(r),s=new URL(r.url),{promise:i,resolve:d}=Promise.withResolvers(),f={writeHeaders(l){let{statusCode:c,cookies:p,headers:h}=l,x=new Headers(h);for(let M of p)x.append("Set-Cookie",M);s.hostname==="localhost"&&x.set("Content-Encoding","identity");let{readable:k,writable:T}=new TransformStream({transform(M,xe){xe.enqueue(Uint8Array.from(M.chunk??M))}}),H=Pr.has(c)?null:k,_=new Response(H,{status:c,headers:x});return d(_),Cr.fromWeb(T)}};return a.waitUntil(e(n,{streamCreator:f,waitUntil:a.waitUntil.bind(a)})),i},Nr={wrapper:Sr,name:"cloudflare-node",supportStreaming:!0}});var tt={};S(tt,{default:()=>Lr});var Ar,Lr,rt=R(()=>{Ar={name:"dummy",mode:"original",getByPath:async()=>[],getByTag:async()=>[],getLastModified:async(e,t)=>t??Date.now(),writeTags:async()=>{}},Lr=Ar});var ot={};S(ot,{default:()=>Tr});var kr,Tr,at=R(()=>{V();kr={name:"dummy",send:async()=>{throw new G("Dummy queue is not implemented")}},Tr=kr});var nt={};S(nt,{default:()=>Mr});var Hr,Mr,st=R(()=>{V();Hr={name:"dummy",get:async()=>{throw new O('"Dummy" cache does not cache anything')},set:async()=>{throw new O('"Dummy" cache does not cache anything')},delete:async()=>{throw new O('"Dummy" cache does not cache anything')}},Mr=Hr});var it={};S(it,{default:()=>jr});var Or,jr,ct=R(()=>{I();Or={name:"fetch-proxy",proxy:async e=>{let{url:t,headers:r,method:o,body:a}=e,n=Object.fromEntries(Object.entries(r).filter(([d])=>d.toLowerCase()!=="cf-connecting-ip")),s=await fetch(t,{method:o,headers:n,body:a}),i={};return s.headers.forEach((d,f)=>{i[f]=d}),{type:"core",headers:i,statusCode:s.status,isBase64Encoded:!0,body:s.body??j()}}},jr=Or});var lt={};S(lt,{default:()=>Ir});var Ir,dt=R(()=>{Ir={name:"dummy",invalidatePaths:e=>Promise.resolve()}});y();import ve from"node:path";import C from"node:fs";import N from"node:path";function ge(e){let t=N.join(e,"required-server-files.json"),r=C.readFileSync(t,"utf-8"),{config:o}=JSON.parse(r);return o}function we(e){let t=N.join(e,"BUILD_ID");return C.readFileSync(t,"utf-8").trim()}function ne(e){let t=N.join(e,"server/pages-manifest.json"),r=C.readFileSync(t,"utf-8");return JSON.parse(r)}function ye(e){return Object.entries(ne(e)).filter(([t,r])=>r.endsWith(".html")).map(([t])=>t)}function Re(e){let t=N.join(e,"routes-manifest.json"),r=C.readFileSync(t,"utf-8"),o=JSON.parse(r),a=o.dataRoutes??[],n={static:a.filter(s=>s.routeKeys===void 0),dynamic:a.filter(s=>s.routeKeys!==void 0)};return{basePath:o.basePath,rewrites:Array.isArray(o.rewrites)?{beforeFiles:[],afterFiles:o.rewrites,fallback:[]}:{beforeFiles:o.rewrites.beforeFiles??[],afterFiles:o.rewrites.afterFiles??[],fallback:o.rewrites.fallback??[]},redirects:o.redirects??[],routes:{static:o.staticRoutes??[],dynamic:o.dynamicRoutes??[],data:n},locales:o.i18n?.locales??[]}}function Ee(e){let t=N.join(e,"app-path-routes-manifest.json");return C.existsSync(t)?JSON.parse(C.readFileSync(t,"utf-8")):{}}function _e(e){let t=N.join(e,"server/middleware-manifest.json"),r=C.readFileSync(t,"utf-8");return JSON.parse(r)}function be(e){let t=N.join(e,"server/functions-config-manifest.json");try{let r=C.readFileSync(t,"utf-8");return JSON.parse(r)}catch{return{functions:{},version:1}}}var b=ve.join(__dirname,".next"),Tt=ve.join(__dirname,".open-next");u({NEXT_DIR:b,OPEN_NEXT_DIR:Tt});var m=ge(b),F=we(b),Ce=ye(b),v=Re(b);var Pe=ne(b);var Se=_e(b);var se=Ee(b),Ne=be(b);y();function Ae(){let e=process.env;e.NODE_ENV=process.env.NODE_ENV??"production"}function Le(){return Math.random().toString(36).slice(2,8)}import{AsyncLocalStorage as dr}from"node:async_hooks";y();B();import{Transform as Mt}from"node:stream";var A="set-cookie",L="This cannot be used in OpenNext",Y=class extends Mt{fixHeaders;onEnd;streamCreator;initialHeaders;statusCode;statusMessage="";headers={};_cookies=[];responseStream;headersSent=!1;_chunks=[];strictContentLength=!1;assignSocket(t){throw new Error(L)}detachSocket(t){throw new Error(L)}writeContinue(t){throw new Error(L)}writeEarlyHints(t,r){throw new Error(L)}writeProcessing(){throw new Error(L)}req;chunkedEncoding=!1;shouldKeepAlive=!0;useChunkedEncodingByDefault=!0;sendDate=!1;connection=null;socket=null;setTimeout(t,r){throw new Error(L)}addTrailers(t){throw new Error(L)}constructor(t,r,o,a){super(),this.fixHeaders=t,this.onEnd=r,this.streamCreator=o,this.initialHeaders=a}get originalResponse(){return this}get finished(){return this.responseStream?this.responseStream?.writableFinished:this.writableFinished}setHeader(t,r){let o=t.toLowerCase();return o===A&&(Array.isArray(r)?this._cookies=r:this._cookies=[r]),this.headers[o]=r,this}removeHeader(t){let r=t.toLowerCase();return r===A?this._cookies=[]:delete this.headers[r],this}hasHeader(t){let r=t.toLowerCase();return r===A?this._cookies.length>0:this.headers[r]!==void 0}getHeaders(){return this.headers}getHeader(t){return this.headers[t.toLowerCase()]}getHeaderNames(){return Object.keys(this.headers)}flushHeaders(){this.headersSent=!0;let t=globalThis.__openNextAls?.getStore()?.mergeHeadersPriority??"middleware";if(this.initialHeaders){this.headers=t==="middleware"?{...this.headers,...this.initialHeaders}:{...this.initialHeaders,...this.headers};let o=K(this.initialHeaders[A]?.toString());this._cookies=t==="middleware"?[...this._cookies,...o]:[...o,...this._cookies]}this.fixHeaders(this.headers),this.fixHeadersForError(),this.headers[A]=this._cookies;let r=J(this.headers);delete r[A],this.streamCreator&&(this.responseStream=this.streamCreator?.writeHeaders({statusCode:this.statusCode??200,cookies:this._cookies,headers:r}),this.pipe(this.responseStream))}appendHeader(t,r){let o=t.toLowerCase();if(!this.hasHeader(o))return this.setHeader(o,r);let a=this.getHeader(o),n=Array.isArray(r)?r:[r],s=Array.isArray(a)?[...a,...n]:[a,...n];return this.setHeader(o,s)}writeHead(t,r,o){let a=o,n;typeof r=="string"?n=r:a=r;let s=this.headers;if(a)if(Array.isArray(a))for(let i=0;i<a.length;i+=2)s[a[i]]=a[i+1];else for(let i of Object.keys(a))s[i]=a[i];return this.statusCode=t,o&&(this.headers=s),this.flushHeaders(),this}getFixedHeaders(){return this.fixHeaders(this.headers),this.fixHeadersForError(),this.headers[A]=this._cookies,this.headers}getBody(){return Buffer.concat(this._chunks)}_internalWrite(t,r){this._chunks.push(Buffer.from(t,r)),this.push(t,r),this.streamCreator?.onWrite?.()}_transform(t,r,o){this.headersSent||this.flushHeaders(),this._internalWrite(t,r),o()}_flush(t){this.headersSent||this.flushHeaders(),globalThis.__openNextAls?.getStore()?.pendingPromiseRunner.add(this.onEnd(this.headers));let r=this.getBody().length;this.streamCreator?.onFinish?.(r),r===0&&process.env.OPEN_NEXT_FORCE_NON_EMPTY_RESPONSE==="true"&&(u('Force writing "SOMETHING" to the response body'),this.push("SOMETHING")),t()}setHeaders(t){return t.forEach((r,o)=>{this.setHeader(o,Array.isArray(r)?r:r.toString())}),this}get sent(){return this.finished||this.headersSent}getHeaderValues(t){let r=this.getHeader(t);if(r!==void 0)return(Array.isArray(r)?r:[r]).map(o=>o.toString())}send(){let t=this.getBody();this.end(t)}body(t){return this.write(t),this}onClose(t){this.on("close",t)}redirect(t,r){return this.setHeader("Location",t),this.statusCode=r,r===308&&this.setHeader("Refresh",`0;url=${t}`),this}fixHeadersForError(){process.env.OPEN_NEXT_DANGEROUSLY_SET_ERROR_HEADERS!=="true"&&(this.statusCode===404||this.statusCode===500)&&(this.headers["cache-control"]="private, no-cache, no-store, max-age=0, must-revalidate")}};import Ot from"node:http";var W=class extends Ot.IncomingMessage{constructor({method:t,url:r,headers:o,body:a,remoteAddress:n}){super({encrypted:!0,readable:!1,remoteAddress:n,address:()=>({port:443}),end:Function.prototype,destroy:Function.prototype}),a&&(o["content-length"]??=String(Buffer.byteLength(a))),Object.assign(this,{ip:n,complete:!0,httpVersion:"1.1",httpVersionMajor:"1",httpVersionMinor:"1",method:t,headers:o,body:a,url:r}),this._read=()=>{this.push(a),this.push(null)}}};y();var Z=class{resolve;reject;promise;constructor(){let t,r;this.promise=new Promise((o,a)=>{t=o,r=a}),this.resolve=t,this.reject=r}},ce=class{promises=[];withResolvers(){let t=new Z;return this.promises.push(t),t}add(t){let r=new Z;this.promises.push(r),t.then(r.resolve,r.reject)}async await(){u(`Awaiting ${this.promises.length} detached promises`),(await Promise.allSettled(this.promises.map(o=>o.promise))).filter(o=>o.status==="rejected").forEach(o=>{w(o.reason)})}};async function jt(){let e=globalThis.__openNextAls.getStore(),t=e?.pendingPromiseRunner.await()??Promise.resolve();if(e?.waitUntil){e.waitUntil(t);return}await t}function It(){let e=Symbol.for("@next/request-context"),t=Symbol.for("@vercel/request-context"),r=globalThis.__openNextAls.getStore(),o=r?.waitUntil??(n=>r?.pendingPromiseRunner.add(n)),a={get:()=>({waitUntil:o})};globalThis[e]=a,process.env.EMULATE_VERCEL_REQUEST_CONTEXT&&(globalThis[t]=a)}function ke({isISRRevalidation:e,waitUntil:t},r){return globalThis.__openNextAls.run({requestId:Math.random().toString(36),pendingPromiseRunner:new ce,isISRRevalidation:e,waitUntil:t},async()=>{It();let o;try{o=await r()}finally{await jt()}return o})}y();var Dt=P("node:module"),ho=Dt._resolveFilename;import Xt from"node:crypto";import{Readable as Oe}from"node:stream";B();y();var $t=new Set(["application/octet-stream","application/epub+zip","application/msword","application/pdf","application/rtf","application/vnd.amazon.ebook","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","font/otf","font/woff","font/woff2","image/bmp","image/gif","image/jpeg","image/png","image/tiff","image/vnd.microsoft.icon","image/webp","audio/3gpp","audio/aac","audio/basic","audio/flac","audio/mpeg","audio/ogg","audio/wavaudio/webm","audio/x-aiff","audio/x-midi","audio/x-wav","video/3gpp","video/mp2t","video/mpeg","video/ogg","video/quicktime","video/webm","video/x-msvideo","application/java-archive","application/vnd.apple.installer+xml","application/x-7z-compressed","application/x-apple-diskimage","application/x-bzip","application/x-bzip2","application/x-gzip","application/x-java-archive","application/x-rar-compressed","application/x-tar","application/x-zip","application/zip","application/x-protobuf"]);function Te(e){if(!e)return!1;let t=e?.split(";")[0]??"";return $t.has(t)}I();y();function Ut(e,t,r){let o=new Map,a=e.replace(/[ \t]/g,"");if(t){let l=0;for(let c of t){let p=c.toLowerCase();if(o.set(p,{orig:c,pos:l++}),r.prefixMatch){let h=p.split("-");for(;h.pop(),h.length>0;){let x=h.join("-");o.has(x)||o.set(x,{orig:c,pos:l++})}}}}let n=a.split(","),s=[],i=new Set;for(let l=0;l<n.length;++l){let c=n[l];if(!c)continue;let p=c.split(";");if(p.length>2)throw new Error(`Invalid ${r.type} header`);let h=p[0].toLowerCase();if(!h)throw new Error(`Invalid ${r.type} header`);let x={token:h,pos:l,q:1};if(t&&o.has(h)&&(x.pref=o.get(h).pos),i.add(x.token),p.length===2){let k=p[1],[T,H]=k.split("=");if(!H||T!=="q"&&T!=="Q")throw new Error(`Invalid ${r.type} header`);let _=Number.parseFloat(H);if(_===0)continue;Number.isFinite(_)&&_<=1&&_>=.001&&(x.q=_)}s.push(x)}s.sort((l,c)=>c.q!==l.q?c.q-l.q:c.pref!==l.pref?l.pref===void 0?1:c.pref===void 0?-1:l.pref-c.pref:l.pos-c.pos);let d=s.map(l=>l.token);if(!t||!t.length)return d;let f=[];for(let l of d)if(l==="*")for(let[c,p]of o)i.has(c)||f.push(p.orig);else{let c=l.toLowerCase();o.has(c)&&f.push(o.get(c).orig)}return f}function He(e="",t){return Ut(e,t,{type:"accept-language",prefixMatch:!0})[0]||void 0}function qt(e){return m.i18n?.locales.includes(e.split("/")[1].toLowerCase())??!1}function Ft(e){let t=m.i18n,r=e.NEXT_LOCALE?.toLowerCase();return r?t?.locales.find(o=>r===o.toLowerCase()):void 0}function Bt({hostname:e,detectedLocale:t}){let o=m.i18n?.domains;if(!o)return;let a=t?.toLowerCase();for(let n of o){let s=n.domain.split(":",1)[0].toLowerCase();if(e===s||a===n.defaultLocale.toLowerCase()||n.locales?.some(i=>a===i.toLowerCase()))return n}}function Me(e,t){let r=Bt({hostname:e.headers.host});if(t.localeDetection===!1)return r?.defaultLocale??t.defaultLocale;let o=Ft(e.cookies),a=He(e.headers["accept-language"],t?.locales);return u({cookiesLocale:o,preferredLocale:a,defaultLocale:t.defaultLocale,domainLocale:r}),r?.defaultLocale??o??a??t.defaultLocale}function z(e){let t=m.i18n;return!t||qt(e.rawPath)?e.rawPath:`/${Me(e,t)}${e.rawPath}`}function Wt(e,t,r){let o=zt(e),a=o+=1831565813;a=Math.imul(a^a>>>15,a|1),a^=a+Math.imul(a^a>>>7,a|61);let n=((a^a>>>14)>>>0)/4294967296,s=Math.floor(n*t);return`${r}-${s}`}function le(e){let t=Number.parseInt(process.env.MAX_REVALIDATE_CONCURRENCY??"10");return Wt(e,t,"revalidate")}function zt(e){let t=1779033703,r=3144134277,o=1013904242,a=2773480762;for(let n=0,s;n<e.length;n++)s=e.charCodeAt(n),t=r^Math.imul(t^s,597399067),r=o^Math.imul(r^s,2869860233),o=a^Math.imul(o^s,951274213),a=t^Math.imul(a^s,2716044179);return t=Math.imul(o^t>>>18,597399067),r=Math.imul(a^r>>>22,2869860233),o=Math.imul(t^o>>>17,951274213),a=Math.imul(r^a>>>19,2716044179),t^=r^o^a,r^=t,o^=t,a^=t,t>>>0}function X(e,t){let r=m.basePath??"";return new URL(`${r}${t}`,e).href}function je(e){let t=e.statusCode||200,r=J(e.getFixedHeaders()),o=Te(r["content-type"])||!!r["content-encoding"],a=Oe.toWeb(Oe.from(e.getBody()));return{type:"core",statusCode:t,headers:r,body:a,isBase64Encoded:o}}function Ie(e){let t=new URLSearchParams(e),r={};for(let o of t.keys()){let a=t.getAll(o);r[o]=a.length>1?a:a[0]}return r}function De(e,t){if(t?.functions?.["/_middleware"])return t.functions["/_middleware"].matchers?.map(({regexp:o})=>new RegExp(o))??[/.*/];let r=e.middleware["/"];return r?.matchers?r.matchers.map(({regexp:o})=>new RegExp(o)):[]}var g;(function(e){e.CACHE_CONTROL="cache-control",e.NEXT_CACHE="x-nextjs-cache"})(g||(g={}));function Qt(e,t){if(e.rawPath==="/404"||e.rawPath==="/500"){if(process.env.OPEN_NEXT_DANGEROUSLY_SET_ERROR_HEADERS==="true")return;t[g.CACHE_CONTROL]="private, no-cache, no-store, max-age=0, must-revalidate";return}let r=z(e);Ce.includes(r)&&!e.headers["x-middleware-prefetch"]&&(t[g.CACHE_CONTROL]="public, max-age=0, s-maxage=31536000, must-revalidate")}function Gt(e){let t=e[g.CACHE_CONTROL];t&&(Array.isArray(t)&&(t=t.join(",")),typeof t=="string"&&(e[g.CACHE_CONTROL]=t.replace(/\bstale-while-revalidate(?!=)/,"stale-while-revalidate=2592000")))}function Vt(e){m.poweredByHeader&&(e["X-OpenNext"]="1"),globalThis.openNextDebug&&(e["X-OpenNext-Version"]=globalThis.openNextVersion,e["X-OpenNext-RequestId"]=globalThis.__openNextAls.getStore()?.requestId)}async function Jt(e,t,r,o){if(r[g.NEXT_CACHE]==="STALE"){let a=o?.[Symbol.for("NextInternalRequestMeta")],n=a?._nextDidRewrite?t.startsWith("/_next/data/")?`/_next/data/${F}${a?._nextRewroteUrl}.json`:a?._nextRewroteUrl:t;try{let s=f=>Xt.createHash("md5").update(f).digest("hex"),i=globalThis.__openNextAls.getStore()?.lastModified??0,d=`${r.etag??r.ETag??""}`;await globalThis.queue.send({MessageBody:{host:e,url:n,eTag:d,lastModified:i},MessageDeduplicationId:s(`${t}-${i}-${d}`),MessageGroupId:le(t)})}catch(s){w(`Failed to revalidate stale page ${t}`,s)}}}function Kt(e){if(e[g.NEXT_CACHE]==="REVALIDATED"){e[g.CACHE_CONTROL]="private, no-cache, no-store, max-age=0, must-revalidate";return}let t=globalThis.__openNextAls.getStore()?.lastModified??0;if(e[g.NEXT_CACHE]==="HIT"&&t>0){let r=Math.round((Date.now()-t)/1e3),o=/s-maxage=(\d+)/,a=e[g.CACHE_CONTROL];if(u("cache-control",a,t,Date.now()),typeof a!="string")return;let n=a.match(o),s=n?Number.parseInt(n[1]):void 0;if(s&&s!==31536e3){let i=Math.max(s-r,1);e[g.CACHE_CONTROL]=`s-maxage=${i}, stale-while-revalidate=2592000`}}e[g.NEXT_CACHE]==="STALE"&&(e[g.CACHE_CONTROL]="s-maxage=2, stale-while-revalidate=2592000")}function de(e,t,r){let o=e.internalEvent;return new Y(a=>{Qt(o,a),Gt(a),Vt(a),Kt(a)},async a=>{await Jt(o.headers.host,o.rawPath,a),await Yt(e,a)},r,t)}async function Yt(e,t){let{internalEvent:r,resolvedRoutes:o,initialURL:a}=e,n=new URL(a).pathname;!(r.headers["x-isr"]==="1")&&t[g.NEXT_CACHE]==="REVALIDATED"&&await globalThis.cdnInvalidationHandler.invalidatePaths([{initialPath:n,rawPath:r.rawPath,resolvedRoutes:o}])}y();I();y();var Go=60*60*24*365,Vo=60*60*24*30;I();y();var er=`^/(?:${v.locales.map(e=>`${e}/?`).join("|")})?`,tr=v.basePath?`^${v.basePath}/?`:"^/",rr=er.replace("^/",tr);function Ue(e){let t=e.map(a=>({page:a.page,regexp:new RegExp(a.regex.replace("^/",rr))})),r=new Set,o=new Set;for(let[a,n]of Object.entries(se))a.endsWith("page")?r.add(n):a.endsWith("route")&&o.add(n);return function(n){return t.filter(i=>i.regexp.test(n)).map(i=>{let d="page";return r.has(i.page)?d="app":o.has(i.page)&&(d="route"),{route:i.page,type:d}})}}var qe=Ue([...v.routes.static,...or()]),Fe=Ue(v.routes.dynamic);function or(){let e=a=>({page:a,regex:`^${a}(?:/)?$`}),t=new Set(v.routes.dynamic.map(({page:a})=>a)),r=Object.keys(Pe).filter(a=>a.startsWith("/api/")&&!t.has(a)).map(e),o=Object.values(se).filter(a=>a.startsWith("/api/")||a==="/api"&&!t.has(a)).map(e);return[...r,...o]}I();pe();var nr=Se,sr=Ne,ba=De(nr,sr);var fe="x-middleware-response-",Be=fe.length,me="x-opennext-",We=`${me}initial-url`,qa=`${me}locale`,he=`${me}resolved-routes`;y();import cr from"next/dist/server/next-server.js";y();var ir=P("node:module"),Wa=ir._resolveFilename;var lr=P.resolve("./cache.cjs"),en=P.resolve("./composable-cache.cjs"),$=new cr.default({conf:{...m,compress:!1,cacheHandler:lr,cacheMaxMemorySize:0,experimental:{...m.experimental,trustHostHeader:!0}},customServer:!1,dev:!1,dir:__dirname}),D=!1;globalThis.__next_route_preloader=async e=>{if(D)return;let r=(globalThis.fnName?globalThis.openNextConfig.functions[globalThis.fnName]:globalThis.openNextConfig.default)?.routePreloadingBehavior??"none";if(r==="none"){D=!0;return}if(!("unstable_preloadEntries"in $)){u("The current version of Next.js does not support route preloading. Skipping route preloading."),D=!0;return}if(e==="waitUntil"&&r==="withWaitUntil"){let o=globalThis.__openNextAls.getStore()?.waitUntil;if(!o){w("You've tried to use the 'withWaitUntil' route preloading behavior, but the 'waitUntil' function is not available."),D=!0;return}u("Preloading entries with waitUntil"),o?.($.unstable_preloadEntries()),D=!0}else if(e==="start"&&r==="onStart"||e==="warmerEvent"&&r==="onWarmerEvent"||e==="onDemand"){let o=Date.now();u("Preloading entries"),await $.unstable_preloadEntries(),u("Preloading entries took",Date.now()-o,"ms"),D=!0}};var te=e=>"getRequestHandlerWithMetadata"in $?$.getRequestHandlerWithMetadata(e):$.getRequestHandler();globalThis.__openNextAls=new dr;async function ze(e,t){let r=e.headers;return ke({isISRRevalidation:r["x-isr"]==="1",waitUntil:t?.waitUntil},async()=>{await globalThis.__next_route_preloader("waitUntil"),r["x-forwarded-host"]&&(r.host=r["x-forwarded-host"]),u("internalEvent",e);let o={initialPath:r[We]??e.rawPath,resolvedRoutes:r[he]?JSON.parse(r[he]):[]},a={internalEvent:e,isExternalRewrite:!1,origin:!1,isISR:!1,initialURL:e.url,...o},n="type"in a?a.headers:a.internalEvent.headers,s={};for(let[E,Q]of Object.entries(n)){if(!E.startsWith(fe))continue;let U=E.slice(Be);U!=="x-middleware-set-cookie"&&(s[U]=Q),n[U]=Q,delete n[E]}if("isExternalRewrite"in a&&a.isExternalRewrite===!0)try{a=await globalThis.proxyExternalRequest.proxy(a.internalEvent)}catch(E){w("External request failed.",E),a={internalEvent:{type:"core",rawPath:"/500",method:"GET",headers:{},url:X(e.url,"/500"),query:{},cookies:{},remoteAddress:""},isExternalRewrite:!1,isISR:!1,origin:!1,initialURL:e.url,resolvedRoutes:[{route:"/500",type:"page"}]}}if("type"in a){if(t?.streamCreator){let E=de({internalEvent:e,isExternalRewrite:!1,isISR:!1,resolvedRoutes:[],origin:!1,initialURL:e.url},a.headers,t.streamCreator);E.statusCode=a.statusCode,E.flushHeaders();let[Q,U]=a.body.tee();for await(let yt of Q)E.write(yt);E.end(),a.body=U}return a}let i=a.internalEvent;u("preprocessedEvent",i);let{search:d,pathname:f,hash:l}=new URL(i.url),c={method:i.method,url:`${f}${d}${l}`,headers:{...n},body:i.body,remoteAddress:i.remoteAddress},p=globalThis.openNextConfig.dangerous?.headersAndCookiesPriority?globalThis.openNextConfig.dangerous.headersAndCookiesPriority(i):"middleware",h=globalThis.__openNextAls.getStore();h&&(h.mergeHeadersPriority=p);let x=new W(c),k=de(a,s,t?.streamCreator);await ur(x,k,a);let{statusCode:T,headers:H,isBase64Encoded:_,body:M}=je(k);return{type:e.type,statusCode:T,headers:H,body:M,isBase64Encoded:_}})}async function ur(e,t,r){delete e.body;let o=new URL(r.initialURL),a;r.internalEvent.rawPath==="/500"?a=500:r.internalEvent.rawPath==="/404"&&(a=404);let n={isNextDataReq:r.internalEvent.query.__nextDataReq==="1",initURL:r.initialURL,initQuery:Ie(o.search),initProtocol:o.protocol,defaultLocale:m.i18n?.defaultLocale,locale:r.locale,middlewareInvoke:!1,invokePath:r.internalEvent.rawPath,invokeQuery:r.internalEvent.query,invokeStatus:a};try{await te(n)(e,t)}catch(s){s.constructor.name==="NoFallbackError"?await Xe(e,t,r,n):(w("NextJS request failed.",s),await re("500",t,r.internalEvent))}}async function Xe(e,t,r,o,a=1){if(a>=5){await re("500",t,r.internalEvent);return}if(a>=r.resolvedRoutes.length){await re("404",t,r.internalEvent);return}try{await te({...r,invokeOutput:r.resolvedRoutes[a].route,...o})(e,t)}catch(n){n.constructor.name==="NoFallbackError"?await Xe(e,t,r,o,a+1):(w("NextJS request failed.",n),await re("500",t,r.internalEvent))}}async function re(e,t,r){try{let o=new W({method:"GET",url:`/${e}`,headers:r.headers,body:r.body,remoteAddress:r.remoteAddress});await te({invokePath:e==="404"?"/404":"/500",invokeStatus:e==="404"?404:500,middlewareInvoke:!1})(o,t)}catch(o){w("NextJS request failed.",o),t.setHeader("Content-Type","application/json"),t.end(JSON.stringify({message:"Server failed to respond.",details:o},null,2))}}async function ut(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(Ye(),Ke))).default}async function pt(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(et(),Ze))).default}async function ft(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(rt(),tt))).default}async function mt(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(at(),ot))).default}async function ht(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(st(),nt))).default}async function xt(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(ct(),it))).default}async function gt(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(dt(),lt))).default}async function wt(){let e=await import("./open-next.config.mjs").then(n=>n.default),t=globalThis.fnName?e.functions[globalThis.fnName]:e.default;globalThis.serverId=Le(),globalThis.openNextConfig=e,await globalThis.__next_route_preloader("start"),globalThis.queue=await mt(t.override?.queue),globalThis.incrementalCache=await ht(t.override?.incrementalCache),globalThis.tagCache=await ft(t.override?.tagCache),globalThis.proxyExternalRequest=await xt(t.override?.proxyExternalRequest),globalThis.cdnInvalidationHandler=await gt(t.override?.cdnInvalidation);let r=await ut(t.override?.converter),{wrapper:o,name:a}=await pt(t.override?.wrapper);return u("Using wrapper",a),o(ze,r)}Ae();$r();Dr();globalThis.internalFetch=fetch;var Mn=await wt();function Dr(){process.chdir(__dirname)}function $r(){process.env.NEXT_BUILD_ID=F}export{Mn as handler};
